% File: MMdbDiagram.mpinput rboxesinput TEXTEXPRE("%&latex" & char(10) & "\documentclass{report}\begin{document}");TEXPOST("\end{document}");numeric gap, arrowFactor, roundOut;pair arrowStartCorrection, arrowEndCorrection, roundOutCorrection;pair leftGap, rightGap;arrowFactor := 3;gap := 16;roundOut := 4;arrowStartCorrection := (arrowFactor / 2, 0);arrowEndCorrection := (arrowFactor / 1.1, 0);roundOutCorrection := (roundOut, 0);leftGap := (5, 0);rightGap := (7, 0);defaultdx := 0;% Make the output recognizable as EPS and embed any needed fonts, for viewingprologues := 3;beginfig(-1);% Keywords/4boxit.KeywordsTitle(btex\strut\tt{}Keywords etex);boxit.keywordFieldLeft(btex\strut\tt$\kappa$ etex);boxit.keywordFieldCentre(btex\strut\tt{}keyword etex);boxit.keywordFieldRight(btex\strut\tt{}Text:I:U etex);KeywordsTitle.sw = keywordFieldLeft.nw;KeywordsTitle.se = keywordFieldRight.ne;keywordFieldLeft.e + leftGap = keywordFieldCentre.w;keywordFieldCentre.e + rightGap = keywordFieldRight.w;drawunboxed(keywordFieldLeft, keywordFieldCentre, keywordFieldRight, KeywordsTitle);rboxit.Keywords(btex etex);xpart Keywords.w = xpart KeywordsTitle.w - roundOut;xpart Keywords.e = xpart KeywordsTitle.e + roundOut;ypart Keywords.n = ypart KeywordsTitle.n + roundOut;ypart Keywords.s = ypart keywordFieldCentre.s - roundOut;drawboxed(Keywords);draw keywordFieldLeft.nw - roundOutCorrection --				keywordFieldRight.ne + roundOutCorrection;% RequestsKeywords/5boxit.RequestsKeywordsTitle(btex\strut\tt{}RequestsKeywords etex);boxit.keywordsIdFieldLeft(btex\strut\tt$\iota$ etex);boxit.keywordsIdFieldCentre(btex\strut\tt{}keywords$\_$id etex);boxit.keywordsIdFieldRight(btex\strut\tt{}Text:I:N etex);boxit.requestsIdFieldLeft(btex\strut\tt$\iota$ etex);boxit.requestsIdFieldCentre(btex\strut\tt{}requests$\_$id etex);boxit.requestsIdFieldRight(btex\strut\tt{}Integer:I:N etex);boxit.requestsKeywordsKeywordsIdIdxFieldLeft(btex\strut\tt$\dagger$ etex);boxit.requestsKeywordsKeywordsIdIdxFieldCentre(						btex\strut\tt{}RequestsKeywords$\_$Keywords$\_$id$\_$idx etex);boxit.requestsKeywordsKeywordsIdIdxFieldRight(btex\strut\tt{}keywords$\_$id etex);boxit.requestsKeywordsRequestsIdIdxFieldLeft(btex\strut\tt$\dagger$ etex);boxit.requestsKeywordsRequestsIdIdxFieldCentre(						btex\strut\tt{}RequestsKeywords$\_$Requests$\_$id$\_$idx etex);boxit.requestsKeywordsRequestsIdIdxFieldRight(btex\strut\tt{}requests$\_$id etex);xpart RequestsKeywordsTitle.w = xpart Keywords.e + 8gap;ypart RequestsKeywordsTitle.n = ypart Keywords.n + gap;RequestsKeywordsTitle.sw = keywordsIdFieldLeft.nw;RequestsKeywordsTitle.se = keywordsIdFieldRight.ne;keywordsIdFieldLeft.sw = requestsIdFieldLeft.nw;keywordsIdFieldRight.se = requestsIdFieldRight.ne;requestsIdFieldLeft.sw = requestsKeywordsKeywordsIdIdxFieldLeft.nw;requestsIdFieldRight.se = requestsKeywordsKeywordsIdIdxFieldRight.ne;requestsKeywordsKeywordsIdIdxFieldLeft.sw = requestsKeywordsRequestsIdIdxFieldLeft.nw;requestsKeywordsKeywordsIdIdxFieldRight.se = requestsKeywordsRequestsIdIdxFieldRight.ne;requestsKeywordsKeywordsIdIdxFieldLeft.e + leftGap =											requestsKeywordsKeywordsIdIdxFieldCentre.w;requestsKeywordsKeywordsIdIdxFieldCentre.e + rightGap =											requestsKeywordsKeywordsIdIdxFieldRight.w;keywordsIdFieldCentre.w = (xpart requestsKeywordsKeywordsIdIdxFieldCentre.w,							ypart keywordsIdFieldLeft.e);requestsIdFieldCentre.w = (xpart requestsKeywordsKeywordsIdIdxFieldCentre.w,							ypart requestsIdFieldLeft.e);requestsKeywordsKeywordsIdIdxFieldCentre.w =										(xpart requestsKeywordsKeywordsIdIdxFieldCentre.w,										ypart requestsKeywordsKeywordsIdIdxFieldLeft.e);requestsKeywordsRequestsIdIdxFieldCentre.w =										(xpart requestsKeywordsKeywordsIdIdxFieldCentre.w,										ypart requestsKeywordsRequestsIdIdxFieldLeft.e);drawunboxed(requestsKeywordsKeywordsIdIdxFieldLeft,			requestsKeywordsKeywordsIdIdxFieldCentre,			requestsKeywordsKeywordsIdIdxFieldRight, RequestsKeywordsTitle,			requestsIdFieldLeft, requestsIdFieldCentre, requestsIdFieldRight,			keywordsIdFieldLeft, keywordsIdFieldCentre, keywordsIdFieldRight,			requestsKeywordsRequestsIdIdxFieldLeft,			requestsKeywordsRequestsIdIdxFieldCentre,			requestsKeywordsRequestsIdIdxFieldRight);rboxit.RequestsKeywords(btex etex);xpart RequestsKeywords.w = xpart RequestsKeywordsTitle.w - roundOut;xpart RequestsKeywords.e = xpart RequestsKeywordsTitle.e + roundOut;ypart RequestsKeywords.n = ypart RequestsKeywordsTitle.n + roundOut;ypart RequestsKeywords.s = ypart requestsKeywordsRequestsIdIdxFieldCentre.s - roundOut;drawboxed(RequestsKeywords);draw keywordsIdFieldLeft.nw - roundOutCorrection --				keywordsIdFieldRight.ne + roundOutCorrection;draw requestsIdFieldLeft.nw - roundOutCorrection --				requestsIdFieldRight.ne + roundOutCorrection dashed evenly;draw requestsKeywordsKeywordsIdIdxFieldLeft.nw - roundOutCorrection --				requestsKeywordsKeywordsIdIdxFieldRight.ne + roundOutCorrection dashed				evenly;draw requestsKeywordsRequestsIdIdxFieldLeft.nw - roundOutCorrection --				requestsKeywordsRequestsIdIdxFieldRight.ne + roundOutCorrection dashed				evenly;% Services/6boxit.ServicesTitle(btex\strut\tt{}Services etex);boxit.channelNameField2Left(btex\strut\tt$\kappa$ etex);boxit.channelNameField2Centre(btex\strut\tt{}channelname etex);boxit.channelNameField2Right(btex\strut\tt{}Text:I:U etex);boxit.descriptionFieldLeft(btex\strut\tt$\diamond$ etex);boxit.descriptionFieldCentre(btex\strut\tt{}description etex);boxit.descriptionFieldRight(btex\strut\tt{}Text etex);boxit.executableFieldLeft(btex\strut\tt$\diamond$ etex);boxit.executableFieldCentre(btex\strut\tt{}executable etex);boxit.executableFieldRight(btex\strut\tt{}Text etex);boxit.extraInfoFieldLeft(btex\strut\tt$\diamond$ etex);boxit.extraInfoFieldCentre(btex\strut\tt{}extraInfo etex);boxit.extraInfoFieldRight(btex\strut\tt{}Text etex);boxit.nameFieldLeft(btex\strut\tt$\iota$ etex);boxit.nameFieldCentre(btex\strut\tt{}name etex);boxit.nameFieldRight(btex\strut\tt{}Text:I etex);boxit.requestsDescriptionFieldLeft(btex\strut\tt$\diamond$ etex);boxit.requestsDescriptionFieldCentre(btex\strut\tt{}requestsdescription etex);boxit.requestsDescriptionFieldRight(btex\strut\tt{}Text etex);boxit.tagFieldLeft(btex\strut\tt$\diamond$ etex);boxit.tagFieldCentre(btex\strut\tt{}tag etex);boxit.tagFieldRight(btex\strut\tt{}Text etex);boxit.servicesNameIdxFieldLeft(btex\strut\tt$\dagger$ etex);boxit.servicesNameIdxFieldCentre(btex\strut\tt{}Services$\_$name$\_$idx etex);boxit.servicesNameIdxFieldRight(btex\strut\tt{}name etex);xpart ServicesTitle.w = xpart KeywordsTitle.w;ypart ServicesTitle.n = ypart RequestsKeywords.s - 2gap;ServicesTitle.sw = channelNameField2Left.nw;ServicesTitle.se = channelNameField2Right.ne;channelNameField2Left.sw = descriptionFieldLeft.nw;channelNameField2Right.se = descriptionFieldRight.ne;descriptionFieldLeft.sw = executableFieldLeft.nw;descriptionFieldRight.se = executableFieldRight.ne;executableFieldLeft.sw = extraInfoFieldLeft.nw;executableFieldRight.se = extraInfoFieldRight.ne;extraInfoFieldLeft.sw = nameFieldLeft.nw;extraInfoFieldRight.se = nameFieldRight.ne;nameFieldLeft.sw = requestsDescriptionFieldLeft.nw;nameFieldRight.se = requestsDescriptionFieldRight.ne;requestsDescriptionFieldLeft.sw = tagFieldLeft.nw;requestsDescriptionFieldRight.se = tagFieldRight.ne;tagFieldLeft.sw = servicesNameIdxFieldLeft.nw;tagFieldRight.se = servicesNameIdxFieldRight.ne;requestsDescriptionFieldLeft.e + leftGap = requestsDescriptionFieldCentre.w;requestsDescriptionFieldCentre.e + rightGap = requestsDescriptionFieldRight.w;channelNameField2Centre.w = (xpart requestsDescriptionFieldCentre.w,								ypart channelNameField2Left.e);descriptionFieldCentre.w = (xpart requestsDescriptionFieldCentre.w,								ypart descriptionFieldLeft.e);extraInfoFieldCentre.w = (xpart requestsDescriptionFieldCentre.w,								ypart extraInfoFieldLeft.e);executableFieldCentre.w = (xpart requestsDescriptionFieldCentre.w,								ypart executableFieldLeft.e);nameFieldCentre.w = (xpart requestsDescriptionFieldCentre.w, ypart nameFieldLeft.e);tagFieldCentre.w = (xpart requestsDescriptionFieldCentre.w, ypart tagFieldLeft.e);servicesNameIdxFieldCentre.w = (xpart requestsDescriptionFieldCentre.w,								ypart servicesNameIdxFieldLeft.e);drawunboxed(requestsDescriptionFieldLeft, requestsDescriptionFieldCentre,			requestsDescriptionFieldRight, ServicesTitle, channelNameField2Left,			channelNameField2Centre, channelNameField2Right, descriptionFieldLeft,			descriptionFieldCentre, descriptionFieldRight, executableFieldLeft,			executableFieldCentre, executableFieldRight, extraInfoFieldLeft,			extraInfoFieldCentre, extraInfoFieldRight, nameFieldLeft, nameFieldCentre,			nameFieldRight, tagFieldLeft, tagFieldCentre, tagFieldRight,			servicesNameIdxFieldLeft, servicesNameIdxFieldCentre,			servicesNameIdxFieldRight);rboxit.Services(btex etex);xpart Services.w = xpart ServicesTitle.w - roundOut;xpart Services.e = xpart ServicesTitle.e + roundOut;ypart Services.n = ypart ServicesTitle.n + roundOut;ypart Services.s = ypart servicesNameIdxFieldCentre.s - roundOut;drawboxed(Services);draw channelNameField2Left.nw - roundOutCorrection --				channelNameField2Right.ne + roundOutCorrection;draw descriptionFieldLeft.nw - roundOutCorrection --				descriptionFieldRight.ne + roundOutCorrection dashed evenly;draw executableFieldLeft.nw - roundOutCorrection --				executableFieldRight.ne + roundOutCorrection dashed evenly;draw extraInfoFieldLeft.nw - roundOutCorrection --				extraInfoFieldRight.ne + roundOutCorrection dashed evenly;draw nameFieldLeft.nw - roundOutCorrection --				nameFieldRight.ne + roundOutCorrection dashed evenly;draw requestsDescriptionFieldLeft.nw - roundOutCorrection --				requestsDescriptionFieldRight.ne + roundOutCorrection dashed evenly;draw tagFieldLeft.nw - roundOutCorrection --				tagFieldRight.ne + roundOutCorrection dashed evenly;draw servicesNameIdxFieldLeft.nw - roundOutCorrection --				servicesNameIdxFieldRight.ne + roundOutCorrection dashed evenly;% Requests/7boxit.RequestsTitle(btex\strut\tt{}Requests etex);boxit.channelNameField3Left(btex\strut\tt$\iota$ etex);boxit.channelNameField3Centre(btex\strut\tt{}channelname etex);boxit.channelNameField3Right(btex\strut\tt{}Text:I:U etex);boxit.detailsFieldLeft(btex\strut\tt$\diamond$ etex);boxit.detailsFieldCentre(btex\strut\tt{}details etex);boxit.detailsFieldRight(btex\strut\tt{}Text:N etex);boxit.inputFieldLeft(btex\strut\tt$\diamond$ etex);boxit.inputFieldCentre(btex\strut\tt{}input etex);boxit.inputFieldRight(btex\strut\tt{}Text:N etex);boxit.keyField2Left(btex\strut\tt$\kappa$ etex);boxit.keyField2Centre(btex\strut\tt{}key etex);boxit.keyField2Right(btex\strut\tt{}Integer:N etex);boxit.outputFieldLeft(btex\strut\tt$\diamond$ etex);boxit.outputFieldCentre(btex\strut\tt{}output etex);boxit.outputFieldRight(btex\strut\tt{}Text:N etex);boxit.requestFieldLeft(btex\strut\tt$\iota$ etex);boxit.requestFieldCentre(btex\strut\tt{}request etex);boxit.requestFieldRight(btex\strut\tt{}Text:I etex);boxit.versionFieldLeft(btex\strut\tt$\diamond$ etex);boxit.versionFieldCentre(btex\strut\tt{}version etex);boxit.versionFieldRight(btex\strut\tt{}Text:N etex);boxit.requestsChannelnameIdxFieldLeft(btex\strut\tt$\dagger$ etex);boxit.requestsChannelnameIdxFieldCentre(btex\strut\tt{}Requests$\_$channelname$\_$idx										etex);boxit.requestsChannelnameIdxFieldRight(btex\strut\tt{}channelname etex);boxit.requestsRequestIdxFieldLeft(btex\strut\tt$\dagger$ etex);boxit.requestsRequestIdxFieldCentre(btex\strut\tt{}Requests$\_$request$\_$idx etex);boxit.requestsRequestIdxFieldRight(btex\strut\tt{}request etex);xpart RequestsTitle.w = xpart RequestsKeywordsTitle.w;ypart RequestsTitle.n = ypart ServicesTitle.n;RequestsTitle.sw = channelNameField3Left.nw;RequestsTitle.se = channelNameField3Right.ne;channelNameField3Left.sw = detailsFieldLeft.nw;channelNameField3Right.se = detailsFieldRight.ne;detailsFieldLeft.sw = inputFieldLeft.nw;detailsFieldRight.se = inputFieldRight.ne;inputFieldLeft.sw = keyField2Left.nw;inputFieldRight.se = keyField2Right.ne;keyField2Left.sw = outputFieldLeft.nw;keyField2Right.se = outputFieldRight.ne;outputFieldLeft.sw = requestFieldLeft.nw;outputFieldRight.se = requestFieldRight.ne;requestFieldLeft.sw = versionFieldLeft.nw;requestFieldRight.se = versionFieldRight.ne;versionFieldLeft.sw = requestsChannelnameIdxFieldLeft.nw;versionFieldRight.se = requestsChannelnameIdxFieldRight.ne;requestsChannelnameIdxFieldLeft.sw = requestsRequestIdxFieldLeft.nw;requestsChannelnameIdxFieldRight.se = requestsRequestIdxFieldRight.ne;requestsChannelnameIdxFieldLeft.e + leftGap = requestsChannelnameIdxFieldCentre.w;requestsChannelnameIdxFieldCentre.e + rightGap = requestsChannelnameIdxFieldRight.w;channelNameField3Centre.w = (xpart requestsChannelnameIdxFieldCentre.w,							ypart channelNameField3Left.e);detailsFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w,						ypart detailsFieldLeft.e);inputFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w, ypart inputFieldLeft.e);keyField2Centre.w = (xpart requestsChannelnameIdxFieldCentre.w, ypart keyField2Left.e);outputFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w,						ypart outputFieldLeft.e);requestFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w,						ypart requestFieldLeft.e);versionFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w,						ypart versionFieldLeft.e);requestsRequestIdxFieldCentre.w = (xpart requestsChannelnameIdxFieldCentre.w,									ypart requestsRequestIdxFieldLeft.e);drawunboxed(requestsChannelnameIdxFieldLeft, requestsChannelnameIdxFieldCentre,			requestsChannelnameIdxFieldRight, RequestsTitle, channelNameField3Left,			channelNameField3Centre, channelNameField3Right, detailsFieldLeft,			detailsFieldCentre, detailsFieldRight, inputFieldLeft, inputFieldCentre,			inputFieldRight, keyField2Left, keyField2Centre, keyField2Right,			outputFieldLeft, outputFieldCentre, outputFieldRight, requestFieldLeft,			requestFieldCentre, requestFieldRight, versionFieldLeft, versionFieldCentre,			versionFieldRight, requestsRequestIdxFieldLeft, requestsRequestIdxFieldCentre,			requestsRequestIdxFieldRight);rboxit.Requests(btex etex);xpart Requests.w = xpart RequestsTitle.w - roundOut;xpart Requests.e = xpart RequestsTitle.e + roundOut;ypart Requests.n = ypart RequestsTitle.n + roundOut;ypart Requests.s = ypart requestsRequestIdxFieldCentre.s - roundOut;drawboxed(Requests);draw channelNameField3Left.nw - roundOutCorrection --				channelNameField3Right.ne + roundOutCorrection;draw detailsFieldLeft.nw - roundOutCorrection --				detailsFieldRight.ne + roundOutCorrection dashed evenly;draw inputFieldLeft.nw - roundOutCorrection --				inputFieldRight.ne + roundOutCorrection dashed evenly;draw keyField2Left.nw - roundOutCorrection --				keyField2Right.ne + roundOutCorrection dashed evenly;draw outputFieldLeft.nw - roundOutCorrection --				outputFieldRight.ne + roundOutCorrection dashed evenly;draw requestFieldLeft.nw - roundOutCorrection --				requestFieldRight.ne + roundOutCorrection dashed evenly;draw versionFieldLeft.nw - roundOutCorrection --				versionFieldRight.ne + roundOutCorrection dashed evenly;draw requestsChannelnameIdxFieldLeft.nw - roundOutCorrection --				requestsChannelnameIdxFieldRight.ne + roundOutCorrection dashed evenly;draw requestsRequestIdxFieldLeft.nw - roundOutCorrection --				requestsRequestIdxFieldRight.ne + roundOutCorrection dashed evenly;boxit.Legend(btex\strut\tt{}Legend:\ $\kappa$ = key field, $\iota$ = indexed field,				$\dagger$ = index, $\diamond$ = data field, $\cup$ = uniqueness constraint				etex);xpart Legend.w = xpart Services.w;ypart Legend.n = ypart Requests.s - gap;drawunboxed(Legend);pickup pencircle scaled arrowFactor;ahlength := 6;ahangle := 60;linejoin := mitered;liecap := butt;drawarrow keywordsIdFieldLeft.w - (arrowStartCorrection + roundOutCorrection) --								((xpart keywordsIdFieldLeft.w +								xpart keywordFieldRight.e) / 2,								ypart keywordsIdFieldLeft.w) --								((xpart keywordsIdFieldLeft.w +								xpart keywordFieldRight.e) / 2,								ypart keywordFieldRight.e) -- keywordFieldRight.e +								(arrowEndCorrection + roundOutCorrection);			drawarrow requestsIdFieldRight.e + (arrowStartCorrection + roundOutCorrection) --								(xpart (requestsIdFieldRight.e + (arrowStartCorrection +								roundOutCorrection)) + 1.25gap,								ypart requestsIdFieldRight.e) --								(xpart (requestsIdFieldRight.e + (arrowStartCorrection +								roundOutCorrection)) + 1.25gap,								ypart keyField2Right.e) -- keyField2Right.e +								(arrowEndCorrection + roundOutCorrection);drawarrow channelNameField3Left.w - (arrowStartCorrection + roundOutCorrection) --								channelNameField2Right.e + (arrowEndCorrection +								roundOutCorrection);endfig;end