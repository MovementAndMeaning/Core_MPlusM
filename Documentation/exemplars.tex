\ProvidesFile{exemplars.tex}[v1.0.0]
\appendixStart[UsingExemplars]{\textitcorr{Using~the~Exemplar~Files}}%
The exemplars that are part of the \mplusm{} set of source files are
provided as templates for custom application development.
They are based on the example applications, modified to be buildable outside the \mplusm{}
environment, provided that the \mplusm{} libraries and headers have been installed.\\

The exemplar files use a common namespace, \asCode{Exemplars}, to allow for custom
applications that re--use class names; it is expected that the new applications will use
a unique namespace.
\secondaryStart{Exemplar~directories}
\tertiaryStart{\exemplarsNameD{ExemplarAdapter}}
The files in \exemplarsNameX{ExemplarAdapter} are based on the source files for the
\examplesNameR{Adapters}{mpmRandomNumberAdapter} example application.
The files \asCode{M+MRandomNumberXXX.YYY} correspond to the files
\asCode{M+MExemplarXXX.YYY}, where \asCode{XXX} is \asCode{AdapterData},
\asCode{AdapterMain} or \asCode{InputHandler}.
\tertiaryEnd{\exemplarsNameE{ExemplarAdapter}}
\tertiaryStart{\exemplarsNameD{ExemplarClient}}
The files in \exemplarsNameX{ExemplarClient} are based on the source files for the
\examplesNameR{Clients}{mpmRandomNumberClient} example application.
The files \asCode{M+MRandomNumberXXX.YYY} correspond to the files
\asCode{M+MExemplarXXX.YYY}, where \asCode{XXX} is \asCode{Client} or \asCode{ClientMain}.
\tertiaryEnd{\exemplarsNameE{ExemplarClient}}
\tertiaryStart{\exemplarsNameD{ExemplarCommon}}
The file in \exemplarsNameX{ExemplarCommon} are based on a source file from the
\examplesNameR{Services}{mpmRandomNumberService} example application.
The file \asCode{M+MRandomNumberRequests.h} corresponds to the file
\asCode{M+MExemplarRequests.h}.
\tertiaryEnd{\exemplarsNameE{ExemplarCommon}}
\tertiaryStart{\exemplarsNameD{ExemplarFilterService}}
The files in \exemplarsNameX{ExemplarFilterService} are based on the source files for the
\examplesNameR{Services}{mpmTruncateFilterService} example application.
The files \asCode{M+MTruncateFilterXXX.YYY} correspond to the files
\asCode{M+MExemplarFilterXXX.YYY}, where \asCode{XXX} is \asCode{InputHandler},
\asCode{Requests}, \asCode{Service} or \asCode{ServiceMain}.
\tertiaryEnd{\exemplarsNameE{ExemplarFilterService}}
\tertiaryStart{\exemplarsNameD{ExemplarInputService}}
The files in \exemplarsNameX{ExemplarInputService} are based on the source files for the
\examplesNameR{Services}{mpmRandomBurstService} example application.
The files \asCode{M+MRandomBurstXXX.YYY} correspond to the files
\asCode{M+MExemplarInputXXX.YYY}, where \asCode{XXX} is \asCode{Requests},
\asCode{Service}, \asCode{ServiceMain} or \asCode{Thread}.
\tertiaryEnd{\exemplarsNameE{ExemplarInputService}}
\tertiaryStart{\exemplarsNameD{ExemplarOutputService}}
The files in \exemplarsNameX{ExemplarOutputService} are based on the source files for the
\examplesNameR{Services}{mpmRecordIntegersService} example application.
The files \asCode{M+MRecordIntegersXXX.YYY} correspond to the files
\asCode{M+MExemplarOutputXXX.YYY}, where \asCode{XXX} is \asCode{InputHandler},
\asCode{Requests}, \asCode{Service} or \asCode{ServiceMain}.
\tertiaryEnd{\exemplarsNameE{ExemplarOutputService}}
\tertiaryStart{\exemplarsNameD{ExemplarService}}
The files in \exemplarsNameX{ExemplarService} are based on the source files for the
\examplesNameR{Services}{mpmRandomNumberService} example application.
The files \asCode{M+MRandomNumberXXX.YYY} correspond to the files
\asCode{M+MExemplarXXX.YYY}, where \asCode{XXX} is \asCode{Service} or
\asCode{ServiceMain} and the files \asCode{M+MRandomRequestHandler.YYY} correspond to the
files\\
\asCode{M+MSimpleRequestHandler.YYY}.
\tertiaryEnd{\exemplarsNameE{ExemplarService}}
\secondaryEnd{}
\secondaryStart{Creating~a~custom~application}
\tertiaryStart{Determine the kind of application}
There are four kinds of applications that can be build from the exemplars:
\begin{itemize}
\item \textbf{Client~/~Service~/~Adapter:} This will use the
\exemplarsNameR{ExemplarClient}, \exemplarsNameR{ExemplarCommon} and
\exemplarsNameR{ExemplarService} directories, with the \exemplarsNameR{ExemplarAdapter}
directory, if an adapter is required
\item \textbf{Filter~Service} This will use the \exemplarsNameR{ExemplarFilterService}
directory
\item \textbf{Input~Service} This will use the \exemplarsNameR{ExemplarInputService}
directory
\item \textbf{Output~Service} This will use the \exemplarsNameR{ExemplarOutputService}
directory 
\end{itemize}
A custom application set can include one or more of these applications.
For the purposes of this section, we will include all four kinds of application.
\tertiaryEnd{}
\tertiaryStart{Determine the namespace}
Note that the classes in the source files are all within the \asCode{M+M:Exemplars}
namespace -- this will need to be changed to avoid conflicts with other uses of the
exemplar files.
Choose a name that describes the purpose of the custom application, such as
asCode{Tracker} for an input service to communicate with a tracking device.
For the purposes of this section, we will use the name \asCode{Foo}.
\tertiaryEnd{}
\tertiaryStart{Copy the source files}
Copy the full directories from \asCode{Exemplars}; note that it isn't strictly necessary
to copy a subdirectory if it is not going to be built, but the files at the top level of
the directory are still needed.
\tertiaryEnd{}
\tertiaryStart{Rename the source files}
The description of the relationships between the example directories and the exemplar
directories indicate how this renaming should be done.
For example, the file \asCode{M+MExemplarFilterInputHandler.cpp} would be renamed to
\asCode{M+MFooFilterInputHandler.cpp}.
Doing the renaming at this point will help avoid duplicate files or incorrect file
inclusion.
\tertiaryEnd{}
\tertiaryStart{Edit the source files}
This is by far the biggest task, since it will involve editing every file in each
directory.
\begin{itemize}
\item In the \asCode{CMakeLists.txt} files, change the file references from
\asCode{M+MExemplarXXX} to \asCode{M+MFooXXX}
\item In the \compLang{C++} header and source files, change the class names from
\asCode{ExemplarXXX} to \asCode{FooXXX}, change the file references from
\asCode{M+MExemplarXXX.h} to \asCode{M+MFooXXX.h}, change the namespace from
\asCode{Exemplars} to \asCode{Foo} and replace references to `exemplar' in comments with
`foo'
\item In the main files for each application \textbraceleft\asCode{M+MFooAdapterMain.cpp},
\asCode{M+MFooClientMain.cpp}, et cetera\textbraceright, change any text strings that
contain `exemplar' to contain `foo' or that contain `Exemplar' to contain `Foo' -- these
will most often be the names of \yarp{} network connections and must not conflict with the
ports from other services and clients
\item In the files \asCode{M+MFooRequests.h} and \asCode{M+MFooService.cpp}, replace
\asCode{MpM\textunderscore{}EXEMPLAR\textunderscore{}CANONICAL\textunderscore{}NAME} with
\asCode{MpM\textunderscore{}FOO\textunderscore{}CANONICAL\textunderscore{}NAME}
\item In the files \asCode{M+MFooFilterService.h} and
\asCode{M+MFooFilterServiceMain.cpp}, replace\\
\asCode{DEFAULT\textunderscore{}EXEMPLARFILTER\textunderscore{}SERVICE\textunderscore{}%
NAME} with
\asCode{DEFAULT\textunderscore{}FOOFILTER\textunderscore{}SERVICE\textunderscore{}NAME}
\item In the files \asCode{M+MFooInputService.h} and \asCode{M+MFooInputServiceMain.cpp},
replace\\
\asCode{DEFAULT\textunderscore{}EXEMPLARINPUT\textunderscore{}SERVICE\textunderscore{}%
NAME} with
\asCode{DEFAULT\textunderscore{}FOOINPUT\textunderscore{}SERVICE\textunderscore{}NAME}
\item In the files \asCode{M+MFooOutputService.h} and
\asCode{M+MFooOutputServiceMain.cpp}, replace\\
\asCode{DEFAULT\textunderscore{}EXEMPLAROUTPUT\textunderscore{}SERVICE\textunderscore{}%
NAME} with
\asCode{DEFAULT\textunderscore{}FOOOUTPUT\textunderscore{}SERVICE\textunderscore{}NAME}
\item In the files \asCode{M+MFooService.h} and \asCode{M+MFooServiceMain.cpp}, replace
\asCode{DEFAULT\textunderscore{}EXEMPLAR\textunderscore{}SERVICE\textunderscore{}NAME}
with \asCode{DEFAULT\textunderscore{}FOO\textunderscore{}SERVICE\textunderscore{}NAME}
\item In the files \asCode{M+MFooFilterRequests.h} and \asCode{M+MFooFilterService.cpp},
replace\\
\asCode{MpM\textunderscore{}EXEMPLARFILTER\textunderscore{}CANONICAL\textunderscore{}NAME}
with \asCode{MpM\textunderscore{}FOOFILTER\textunderscore{}CANONICAL\textunderscore{}NAME}
\item In the files \asCode{M+MFooInputRequests.h} and \asCode{M+MFooInputService.cpp},
replace\\
\asCode{MpM\textunderscore{}EXEMPLARINPUT\textunderscore{}CANONICAL\textunderscore{}NAME}
with \asCode{MpM\textunderscore{}FOOINPUT\textunderscore{}CANONICAL\textunderscore{}NAME}
\item In the files \asCode{M+MFooOutputRequests.h} and \asCode{M+MFooOutputService.cpp},
replace\\
\asCode{MpM\textunderscore{}EXEMPLAROUTPUT\textunderscore{}CANONICAL\textunderscore{}NAME}
with \asCode{MpM\textunderscore{}FOOOUTPUT\textunderscore{}CANONICAL\textunderscore{}NAME}
\item In the file \asCode{M+MFooFilterServiceMain.cpp}, replace
\asCode{EXEMPLARFILTER\textunderscore{}OPTIONS} with\\
\asCode{FOOFILTER\textunderscore{}OPTIONS}
\item In the file \asCode{M+MFooInputServiceMain.cpp}, replace
\asCode{EXEMPLARINPUT\textunderscore{}OPTIONS} with\\
\asCode{FOOINPUT\textunderscore{}OPTIONS}
\item In the file \asCode{M+MFooOutputServiceMain.cpp}, replace
\asCode{EXEMPLAROUTPUT\textunderscore{}OPTIONS} with\\
\asCode{FOOOUTPUT\textunderscore{}OPTIONS}
\item In the top--level file \asCode{CMakeLists.txt}, comment out the directories that are
not being built, by putting a hash--mark (or pound sign), `\asCode{\#}' at the beginning
of the \asCode{add\textunderscore{}subdirectory} statement for the directory.
\end{itemize}
\tertiaryEnd{}
\tertiaryStart{Build the application(s)}
At this point, it should be possible to build the custom applications.
The tool \asCode{cmake} is used to create the files that are then processed by the
\asCode{make} program to actually construct the applications.
On the Macintosh, execute `\asCode{ccmake~.}' from a terminal session that has the current
directory set to the top--level directory for the custom files and then perform the
`c' (configure) and `g' (generate) commands.
If \asCode{ccmake} does not exit with success, use the `q' (quit) command and review the
\asCode{CMakeLists.txt} files to make sure that they've been edited correctly -- the error
screen from \asCode{ccmake} will indicate which files have problems.\\

Once \asCode{ccmake} runs successfully, do a `\asCode{cmake~.}'.
This should finish without problems, and can be followed by a `\asCode{make}'.
Errors at this point will be a result of incomplete or incorrect edits and should be easy
to fix.
\tertiaryEnd{}
\tertiaryStart{Add custom code}
Once the applications have successfully built, it's time to add the custom functionality
that is desired.
\begin{itemize}
\item For \inputOutput{} services, any custom configuration data should be gathered from
the command line or requested interactively (in the main files for the service
application) and processed in the \asCode{configure} method of the class for the service;
for an Input or Output service, a typical configuration value might be a device
identifier or a file--system path
\item For Filter services, the processing of its input is done in the \asCode{handleInput}
method in the\\
\asCode{M+MFooFilterInputHandler.cpp} file
\item For Input services, the \asCode{run} method in the \asCode{M+MFooInputThread.cpp}
file is an asynchronous -- relative to \mplusm{} -- to gather input and route it to the
\yarp{} network connections for the service
\item For Output services, the processing of its input is done in the \asCode{handlInput}
method in the\\
\asCode{M+MFooOutputInputHandler.cpp} file
\item For regular services and clients, custom requests must be listed in the
\asCode{M+MFooRequests.h} file, replacing the `simple' request that is present.
These requests must be implemented as new classes in the `\asCode{FooService}' directory
and pointers to instances of the new request handler classes must be added to the
\asCode{FooService} class, using the `simple' request handler as a template.
Corresponding methods will need to be added to the \asCode{FooClient} class, in order to
issue the new requests.
\item For adapters, any new methods added to the \asCode{FooClient} class to support the
new requests for the \asCode{FooService} class will require similar changes to the
\asCode{FooAdapter} class.
\end{itemize}
\tertiaryEnd{}
\tertiaryStart{Install the applications}
Once all the customization has been developed and tested, the applications can then be
installed by executing `\asCode{sudo make install}' from a terminal session in the
top--level directory.
\tertiaryEnd{}
\secondaryEnd{}
\appendixEnd{}
