# File: Makefile

IMAGE_ARCHIVE = mpm_images.tar.gz

IMAGE_DIR = mpm_images

# Intermediate Postscript files

IMpsfiles =

JSpsfiles =

KV2psfiles =

LMpsfiles =

MMMpsfiles = MMMmmmDiagram.ps 

MpMpsfiles = MpMdbDiagram.ps MpMmatchSyntaxrails.ps MpMmpmDiagram.ps

NNpsfiles =

OSpsfiles =

PC2psfiles =

SMpsfiles = 

VDSpsfiles =

# Intermediate Encapsulated Postscript files

IMepsfiles =

JSepsfiles =

KV2epsfiles =

LMepsfiles =

MMMepsfiles = $(IMAGE_DIR)/MMMmmmDiagram.eps 

MpMepsfiles = $(IMAGE_DIR)/MpMdbDiagram.eps $(IMAGE_DIR)/MpMmatchSyntaxrails.eps \
		$(IMAGE_DIR)/MpMmpmDiagram.eps

NNepsfiles =

OSepsfiles =

PC2epsfiles =

SMepsfiles =

VDSepsfiles =

# Intermediate Portable Network Graphics files

Commonpngfiles = $(IMAGE_DIR)/m+m_tight_logo.png

IMpngfiles = 

JSpngfiles = 

KV2pngfiles =

LMpngfiles =

MMMpngfiles = $(IMAGE_DIR)/MMMmmmDiagram.png

MpMpngfiles = $(IMAGE_DIR)/MpMdbDiagram.png $(IMAGE_DIR)/MpMmatchSyntaxrails.png \
		$(IMAGE_DIR)/MpMmpmDiagram.png 

NNpngfiles =

OSpngfiles =

PC2pngfiles =

SMpngfiles =

VDSpngfiles =

# Input bitmap EPS files

IMbitmapepsfiles = $(IMAGE_DIR)/Installer01.eps $(IMAGE_DIR)/Installer02.eps \
		$(IMAGE_DIR)/Installer03.eps $(IMAGE_DIR)/Installer04.eps \
		$(IMAGE_DIR)/Installer05.eps $(IMAGE_DIR)/Installer05a.eps \
		$(IMAGE_DIR)/Installer06.eps $(IMAGE_DIR)/Installer06a.eps \
		$(IMAGE_DIR)/Installer06b.eps $(IMAGE_DIR)/Installer07.eps \
		$(IMAGE_DIR)/Installer08.eps $(IMAGE_DIR)/Runningm+mManager.eps \
		$(IMAGE_DIR)/win_install01.eps $(IMAGE_DIR)/win_install02.eps \
		$(IMAGE_DIR)/win_install03.eps $(IMAGE_DIR)/win_install04.eps \
		$(IMAGE_DIR)/win_install05.eps $(IMAGE_DIR)/win_install06.eps \
		$(IMAGE_DIR)/win_install07.eps $(IMAGE_DIR)/win_install08.eps \
		$(IMAGE_DIR)/win_install09.eps $(IMAGE_DIR)/win_install10.eps \
		$(IMAGE_DIR)/win_install11.eps $(IMAGE_DIR)/win_install12.eps \
		$(IMAGE_DIR)/win_run01.eps

JSbitmapepsfiles = $(IMAGE_DIR)/javaScriptWithEndpoint.eps \
		$(IMAGE_DIR)/javaScriptWithEndpointAndTag.eps $(IMAGE_DIR)/javaScriptWithTag.eps \
		$(IMAGE_DIR)/launchJavaScriptFilterService.eps \
		$(IMAGE_DIR)/runningJavaScriptFilterService.eps

KV2bitmapepsfiles = $(IMAGE_DIR)/configureKinectV2BlobInputService.eps \
		$(IMAGE_DIR)/launchKinectV2BlobInputService.eps \
		$(IMAGE_DIR)/launchKinectV2InputService.eps \
		$(IMAGE_DIR)/runningKinectV2BlobInputService.eps \
		$(IMAGE_DIR)/runningKinectV2InputService.eps

LMbitmapepsfiles = $(IMAGE_DIR)/configureLeapBlobInputService.eps \
		$(IMAGE_DIR)/launchLeapBlobInputService.eps \
		$(IMAGE_DIR)/launchLeapMotionInputService.eps \
		$(IMAGE_DIR)/launchLeapTwoFingersInputService.eps \
		$(IMAGE_DIR)/launchLeapTwoPalmsInputService.eps \
		$(IMAGE_DIR)/runningLeapBlobInputService.eps \
		$(IMAGE_DIR)/runningLeapMotionInputService.eps \
		$(IMAGE_DIR)/runningLeapTwoFingersInputService.eps \
		$(IMAGE_DIR)/runningLeapTwoPalmsInputService.eps

MMMbitmapepsfiles = $(IMAGE_DIR)/afterAdd.eps $(IMAGE_DIR)/afterForcedAdd.eps \
		$(IMAGE_DIR)/appListMenu.eps \
		$(IMAGE_DIR)/backgroundMenuNoHiddenNoSelection.eps \
		$(IMAGE_DIR)/backgroundMenuWithHidden.eps \
		$(IMAGE_DIR)/beforeAdd.eps $(IMAGE_DIR)/beforeRemove.eps \
		$(IMAGE_DIR)/clickAdd.eps $(IMAGE_DIR)/dragAdd.eps \
		$(IMAGE_DIR)/forcedDragAdd.eps \
		$(IMAGE_DIR)/launchAdapterWithoutService.eps \
		$(IMAGE_DIR)/launchRandomBurstInputService.eps \
		$(IMAGE_DIR)/launchRandomNumberAdapter.eps \
		$(IMAGE_DIR)/launchRegistryService.eps \
		$(IMAGE_DIR)/launchServiceSpecifiedEndpoint.eps \
		$(IMAGE_DIR)/launchServiceSpecifiedEndpointAndTag.eps \
		$(IMAGE_DIR)/launchServiceSpecifiedTag.eps \
		$(IMAGE_DIR)/launchYarp.eps $(IMAGE_DIR)/m+mManager.eps \
		$(IMAGE_DIR)/m+mManagerMenu.eps $(IMAGE_DIR)/noRegistryServiceFound.eps \
		$(IMAGE_DIR)/noRunningRegistryService.eps $(IMAGE_DIR)/noRunningYarp.eps \
		$(IMAGE_DIR)/noYarpFound.eps $(IMAGE_DIR)/operationMenuAdapter.eps \
		$(IMAGE_DIR)/operationMenuEntity.eps $(IMAGE_DIR)/operationMenuOutputChannel.eps \
		$(IMAGE_DIR)/operationMenuPort.eps $(IMAGE_DIR)/operationMenuPrimaryChannel.eps \
		$(IMAGE_DIR)/operationMenuRegularChannel.eps \
		$(IMAGE_DIR)/operationMenuService.eps \
		$(IMAGE_DIR)/popupAdapterMetricsDisabled.eps \
		$(IMAGE_DIR)/popupAdapterMetricsEnabled.eps $(IMAGE_DIR)/popupEntity.eps \
		$(IMAGE_DIR)/popupOutputChannelMetricsDisabled.eps \
		$(IMAGE_DIR)/popupOutputChannelMetricsEnabled.eps $(IMAGE_DIR)/popupPort.eps \
		$(IMAGE_DIR)/popupPrimaryChannelMetricsDisabled.eps \
		$(IMAGE_DIR)/popupPrimaryChannelMetricsEnabled.eps \
		$(IMAGE_DIR)/popupRegularChannelMetricsDisabled.eps \
		$(IMAGE_DIR)/popupRegularChannelMetricsEnabled.eps \
		$(IMAGE_DIR)/popupServiceMetricsDisabled.eps \
		$(IMAGE_DIR)/popupServiceMetricsEnabled.eps \
		$(IMAGE_DIR)/recordBlobWithEndpoint.eps \
		$(IMAGE_DIR)/recordBlobWithEndpointAndTag.eps $(IMAGE_DIR)/recordBlobWithTag.eps \
		$(IMAGE_DIR)/recordIntegersWithEndpoint.eps \
		$(IMAGE_DIR)/recordIntegersWithEndpointAndTag.eps \
		$(IMAGE_DIR)/recordIntegersWithTag.eps $(IMAGE_DIR)/recordJSONWithEndpoint.eps \
		$(IMAGE_DIR)/recordJSONWithEndpointAndTag.eps $(IMAGE_DIR)/recordJSONWithTag.eps \
		$(IMAGE_DIR)/runningServiceSpecifiedEndpoint.eps \
		$(IMAGE_DIR)/runningServiceSpecifiedEndpointAndTag.eps \
		$(IMAGE_DIR)/runningServiceSpecifiedTag.eps \
		$(IMAGE_DIR)/serviceChannelMenuMetricsDisabled.eps \
		$(IMAGE_DIR)/serviceChannelMenuMetricsEnabled.eps \
		$(IMAGE_DIR)/serviceMenuMetricsDisabled.eps \
		$(IMAGE_DIR)/serviceMenuMetricsEnabled.eps $(IMAGE_DIR)/stopAdapter.eps \
		$(IMAGE_DIR)/stopRegistryService.eps $(IMAGE_DIR)/stopService.eps \
		$(IMAGE_DIR)/viewMenuNoSelection.eps $(IMAGE_DIR)/viewMenuWithSelection.eps

MpMbitmapepsfiles = $(IMAGE_DIR)/configureAbsorberFilterService.eps \
		$(IMAGE_DIR)/configureBlobOutputService.eps \
		$(IMAGE_DIR)/configureRandomBurstInputService.eps \
		$(IMAGE_DIR)/configureRecordAsJSONOutputService.eps \
		$(IMAGE_DIR)/configureRecordBlobOutputService.eps \
		$(IMAGE_DIR)/configureRecordIntegersOutputService.eps \
		$(IMAGE_DIR)/launchAbsorberFilterService.eps \
		$(IMAGE_DIR)/launchAddressService.eps \
		$(IMAGE_DIR)/launchBlobOutputService.eps \
		$(IMAGE_DIR)/launchEchoService.eps \
		$(IMAGE_DIR)/launchRandomBurstInputService.eps \
		$(IMAGE_DIR)/launchRandomNumberAdapter.eps \
		$(IMAGE_DIR)/launchRandomNumberService.eps \
		$(IMAGE_DIR)/launchRecordAsJSONOutputService.eps \
		$(IMAGE_DIR)/launchRecordBlobOutputService.eps \
		$(IMAGE_DIR)/launchRecordIntegersOutputService.eps \
		$(IMAGE_DIR)/launchRegistryService.eps \
		$(IMAGE_DIR)/launchRequestCounterService.eps \
		$(IMAGE_DIR)/launchRunningSumAdapter.eps \
		$(IMAGE_DIR)/launchRunningSumAltAdapter.eps \
		$(IMAGE_DIR)/launchRunningSumService.eps \
		$(IMAGE_DIR)/launchTruncateFloatFilterService.eps \
		$(IMAGE_DIR)/launchTunnelService.eps \
		$(IMAGE_DIR)/runningAbsorberFilterService.eps \
		$(IMAGE_DIR)/runningAddressService.eps \
		$(IMAGE_DIR)/runningBlobOutputService.eps \
		$(IMAGE_DIR)/runningEchoService.eps \
		$(IMAGE_DIR)/runningRandomBurstInputService.eps \
		$(IMAGE_DIR)/runningRandomNumberAdapter.eps \
		$(IMAGE_DIR)/runningRandomNumberService.eps \
		$(IMAGE_DIR)/runningRecordAsJSONOutputService.eps \
		$(IMAGE_DIR)/runningRecordBlobOutputService.eps \
		$(IMAGE_DIR)/runningRecordIntegersOutputService.eps \
		$(IMAGE_DIR)/runningRegistryService.eps \
		$(IMAGE_DIR)/runningRequestCounterService.eps \
		$(IMAGE_DIR)/runningRunningSumAdapter.eps \
		$(IMAGE_DIR)/runningRunningSumAltAdapter.eps \
		$(IMAGE_DIR)/runningRunningSumService.eps \
		$(IMAGE_DIR)/runningTruncateFloatFilterService.eps \
		$(IMAGE_DIR)/runningTunnelService.eps

NNbitmapepsfiles = $(IMAGE_DIR)/configureNatNetBlobInputService.eps \
		$(IMAGE_DIR)/configureNatNetInputService.eps \
		$(IMAGE_DIR)/launchNatNetBlobInputService.eps \
		$(IMAGE_DIR)/launchNatNetInputService.eps \
		$(IMAGE_DIR)/runningNatNetBlobInputService.eps \
		$(IMAGE_DIR)/runningNatNetInputService.eps

OSbitmapepsfiles = $(IMAGE_DIR)/configureOpenStageBlobInputService.eps \
		$(IMAGE_DIR)/configureOpenStageInputService.eps \
		$(IMAGE_DIR)/launchOpenStageBlobInputService.eps \
		$(IMAGE_DIR)/launchOpenStageInputService.eps \
		$(IMAGE_DIR)/runningOpenStageBlobInputService.eps \
		$(IMAGE_DIR)/runningOpenStageInputService.eps

PC2bitmapepsfiles = $(IMAGE_DIR)/launchProComp2InputService.eps \
		$(IMAGE_DIR)/runningProComp2InputService.eps

SMbitmapepsfiles = $(IMAGE_DIR)/configureSendToMQOutputService.eps \
		$(IMAGE_DIR)/launchSendToMQOutputService.eps \
		$(IMAGE_DIR)/runningSendToMQOutputService.eps

VDSbitmapepsfiles = $(IMAGE_DIR)/configureViconBlobInputService.eps \
		$(IMAGE_DIR)/configureViconDataStreamInputService.eps \
		$(IMAGE_DIR)/launchViconBlobInputService.eps \
		$(IMAGE_DIR)/launchViconDataStreamInputService.eps \
		$(IMAGE_DIR)/runningViconBlobInputService.eps \
		$(IMAGE_DIR)/runningViconDataStreamInputService.eps

# Input bitmap PNG files

IMbitmappngfiles = $(IMbitmapepsfiles:.eps=.png)

JSbitmappngfiles = $(JSbitmapepsfiles:.eps=.png)

KV2bitmappngfiles = $(KV2bitmapepsfiles:.eps=.png)

LMbitmappngfiles = $(LMbitmapepsfiles:.eps=.png)

MMMbitmappngfiles = $(MMMbitmapepsfiles:.eps=.png)

MpMbitmappngfiles = $(MpMbitmapepsfiles:.eps=.png)

NNbitmappngfiles = $(NNbitmapepsfiles:.eps=.png)

OSbitmappngfiles = $(OSbitmapepsfiles:.eps=.png)

PC2bitmappngfiles = $(PC2bitmapepsfiles:.eps=.png)

SMbitmappngfiles = $(SMbitmapepsfiles:.eps=.png)

VDSbitmappngfiles = $(VDSbitmapepsfiles:.eps=.png)

# Main source file

IMmainsource = Installation_Manual.tex

JSmainsource = JavaScript_Manual.tex

KV2mainsource = KinectV2Input_Manual.tex

LMmainsource = LeapMotionInput_Manual.tex

MMMmainsource = MMManagerUtility_Manual.tex

MpMmainsource = MpM_Manual.tex

NNmainsource = NatNetInput_Manual.tex

OSmainsource = OpenStageInput_Manual.tex

PC2mainsource = ProComp2Input_Manual.tex

SMmainsource = SendToMQOutput_Manual.tex

VDSmainsource = ViconDataStreamInput_Manual.tex

# Secondary source files

Commonsources = boilerPlate.tex commonStrings.tex sharedSetup.tex

IMsecondaryfiles = IMdocumentationHistory.tex IMfrontispiece.tex IMinstalling.tex \
		IMoverview.tex IMuninstalling.tex $(Commonsources) $(Commonpngfiles)

JSsecondaryfiles = JSdocumentationHistory.tex JSfrontispiece.tex JSoverview.tex \
		JSfileFormat.tex JSservice.tex JSexamples.tex $(Commonsources) $(Commonpngfiles)
	
KV2secondaryfiles = KV2blobMessageFormat.tex KV2blobService.tex \
		KV2documentationHistory.tex KV2frontispiece.tex KV2messageFormat.tex \
		KV2overview.tex KV2service.tex $(Commonsources) $(Commonpngfiles)

LMsecondaryfiles = LM2FMessageFormat.tex LM2FService.tex LM2PMessageFormat.tex \
		LM2PService.tex LMblobMessageFormat.tex LMblobService.tex \
		LMdocumentationHistory.tex LMfrontispiece.tex LMmessageFormat.tex LMoverview.tex \
		LMservice.tex $(Commonsources) $(Commonpngfiles)

MMMsecondaryfiles = MMMdocumentationHistory.tex MMMfrontispiece.tex \
		MMMmanagingServices.tex MMMnoRegistryService.tex MMMnoYarp.tex MMMoverview.tex \
		MMMtagsAndEndpoints.tex MMMutility.tex $(Commonsources) $(Commonpngfiles)
	
MpMsecondaryfiles = MpMbuildingFromSource.tex MpMcaseStudy.tex MpMclasses.tex \
		MpMdocumentationHistory.tex MpMexamples.tex MpMexemplars.tex MpMfrontispiece.tex \
		MpMinternalDb.tex MpMmatchSyntax.tex MpMoverview.tex MpMregistrationSequence.tex \
		MpMrunningWithHamachi.tex MpMservices.tex MpMtechnology.tex \
		MpMupdatingVersionNumber.tex MpMutilities.tex $(Commonsources) $(Commonpngfiles)

NNsecondaryfiles = NNblobMessageFormat.tex NNblobService.tex NNdocumentationHistory.tex \
		NNfrontispiece.tex NNmessageFormat.tex NNoverview.tex NNservice.tex \
		$(Commonsources) $(Commonpngfiles)

OSsecondaryfiles = OSblobMessageFormat.tex OSblobService.tex OSdocumentationHistory.tex \
		OSfrontispiece.tex OSmessageFormat.tex OSoverview.tex OSservice.tex \
		$(Commonsources) $(Commonpngfiles)

PC2secondaryfiles = PC2documentationHistory.tex PC2frontispiece.tex \
		PC2messageFormat.tex PC2overview.tex PC2service.tex $(Commonsources) \
		$(Commonpngfiles)

SMsecondaryfiles = SMdocumentationHistory.tex SMfrontispiece.tex SMoverview.tex \
		SMservice.tex $(Commonsources) $(Commonpngfiles)

VDSsecondaryfiles = VDSblobMessageFormat.tex VDSblobService.tex \
		VDSdocumentationHistory.tex VDSfrontispiece.tex VDSmessageFormat.tex \
		VDSoverview.tex VDSservice.tex $(Commonsources) $(Commonpngfiles)

# DVI files

IMmaindvi = $(IMmainsource:.tex=.dvi)

JSmaindvi = $(JSmainsource:.tex=.dvi)

KV2maindvi = $(KV2mainsource:.tex=.dvi)

LMmaindvi = $(LMmainsource:.tex=.dvi)

MMMmaindvi = $(MMMmainsource:.tex=.dvi)

MpMmaindvi = $(MpMmainsource:.tex=.dvi)

NNmaindvi = $(NNmainsource:.tex=.dvi)

OSmaindvi = $(OSmainsource:.tex=.dvi)

PC2maindvi = $(PC2mainsource:.tex=.dvi)

SMmaindvi = $(SMmainsource:.tex=.dvi)

VDSmaindvi = $(VDSmainsource:.tex=.dvi)

# Index files

IMmainidx = $(IMmainsource:.tex=.idx)

JSmainidx = $(JSmainsource:.tex=.idx)

KV2mainidx = $(KV2mainsource:.tex=.idx)

LMmainidx = $(LMmainsource:.tex=.idx)

MMMmainidx = $(MMMmainsource:.tex=.idx)

MpMmainidx = $(MpMmainsource:.tex=.idx)

NNmainidx = $(NNmainsource:.tex=.idx)

OSmainidx = $(OSmainsource:.tex=.idx)

PC2mainidx = $(PC2mainsource:.tex=.idx)

SMmainidx = $(SMmainsource:.tex=.idx)

VDSmainidx = $(VDSmainsource:.tex=.idx)

# Intermediate Postscript files

IMmainps = $(IMmainsource:.tex=.ps)

JSmainps = $(JSmainsource:.tex=.ps)

KV2mainps = $(KV2mainsource:.tex=.ps)

LMmainps = $(LMmainsource:.tex=.ps)

MMMmainps = $(MMMmainsource:.tex=.ps)

MpMmainps = $(MpMmainsource:.tex=.ps)

NNmainps = $(NNmainsource:.tex=.ps)

OSmainps = $(OSmainsource:.tex=.ps)

PC2mainps = $(PC2mainsource:.tex=.ps)

SMmainps = $(SMmainsource:.tex=.ps)

VDSmainps = $(VDSmainsource:.tex=.ps)

# Output HTML files

IMmainhtml = $(IMmainsource:.tex=.html)

JSmainhtml = $(JSmainsource:.tex=.html)

KV2mainhtml = $(KV2mainsource:.tex=.html)

LMmainhtml = $(LMmainsource:.tex=.html)

MMMmainhtml = $(MMMmainsource:.tex=.html)

MpMmainhtml = $(MpMmainsource:.tex=.html)

NNmainhtml = $(NNmainsource:.tex=.html)

OSmainhtml = $(OSmainsource:.tex=.html)

PC2mainhtml = $(PC2mainsource:.tex=.html)

SMmainhtml = $(SMmainsource:.tex=.html)

VDSmainhtml = $(VDSmainsource:.tex=.html)

# Output PDF files

IMmainpdf = $(IMmainsource:.tex=.pdf)

JSmainpdf = $(JSmainsource:.tex=.pdf)

KV2mainpdf = $(KV2mainsource:.tex=.pdf)

LMmainpdf = $(LMmainsource:.tex=.pdf)

MMMmainpdf = $(MMMmainsource:.tex=.pdf)

MpMmainpdf = $(MpMmainsource:.tex=.pdf)

NNmainpdf = $(NNmainsource:.tex=.pdf)

OSmainpdf = $(OSmainsource:.tex=.pdf)

PC2mainpdf = $(PC2mainsource:.tex=.pdf)

SMmainpdf = $(SMmainsource:.tex=.pdf)

VDSmainpdf = $(VDSmainsource:.tex=.pdf)

# Target files

ARCHIVEtarget = $(HOME)/$(IMAGE_ARCHIVE)

IMtarget = $(HOME)/$(IMmainpdf) $(HOME)/$(IMmainhtml)

JStarget = $(HOME)/$(JSmainpdf) $(HOME)/$(JSmainhtml)

KV2target = $(HOME)/$(KV2mainpdf) $(HOME)/$(KV2mainhtml)

LMtarget = $(HOME)/$(LMmainpdf) $(HOME)/$(LMmainhtml)

MMMtarget = $(HOME)/$(MMMmainpdf) $(HOME)/$(MMMmainhtml)

MpMtarget = $(HOME)/$(MpMmainpdf) $(HOME)/$(MpMmainhtml)

NNtarget = $(HOME)/$(NNmainpdf) $(HOME)/$(NNmainhtml)

OStarget = $(HOME)/$(OSmainpdf) $(HOME)/$(OSmainhtml)

PC2target = $(HOME)/$(PC2mainpdf) $(HOME)/$(PC2mainhtml)

SMtarget = $(HOME)/$(SMmainpdf) $(HOME)/$(SMmainhtml)

VDStarget = $(HOME)/$(VDSmainpdf) $(HOME)/$(VDSmainhtml)

# General rules

%.eps: %.ps
	ps2eps -f $<

%.png: %.eps
	convert -density 144 -transparent white $< $@

%.ps: %.mp
	mpost -interaction=batchmode -file-line-error $<

%.ps: %.dvi
	dvips -o $@ $<

%.pdf : %.ps
	gs -dCompatibilityLevel=1.2 -dMaxSubsetPct=100 -dNOPAUSE -dBATCH \
		-sDEVICE=pdfwrite -sPAPERSIZE=letter -sOutputFile=$@ \
		-c save pop -f $< -sFONTPATH=.

$(IMAGE_DIR)/%.eps: %.eps
	cp -f $< $@

$(HOME)/%.pdf : %.pdf
	cp -f $< $@

$(HOME)/%.html : %.html
	cp -f $< $@
	-mkdir $(HOME)/$(IMAGE_DIR)
	cp -f $(IMAGE_DIR)/*.png $(HOME)/$(IMAGE_DIR)
	
$(HOME)/%.gz: %.gz
	cp -f $< $@

# Specific rules (DVI)

$(IMmaindvi) : $(IMbitmapepsfiles) $(IMepsfiles) $(IMmainsource) $(IMsecondaryfiles)
	-latex -interaction=batchmode $(IMmainsource)
	-latex -interaction=batchmode $(IMmainsource)
	-latex -interaction=batchmode $(IMmainsource)
	makeindex $(IMmainidx)
	latex -interaction=batchmode $(IMmainsource)

$(JSmaindvi) : $(JSbitmapepsfiles) $(JSepsfiles) $(JSmainsource) $(JSsecondaryfiles)
	-latex -interaction=batchmode $(JSmainsource)
	-latex -interaction=batchmode $(JSmainsource)
	-latex -interaction=batchmode $(JSmainsource)
	makeindex $(JSmainidx)
	latex -interaction=batchmode $(JSmainsource)

$(KV2maindvi) : $(KV2bitmapepsfiles) $(KV2epsfiles) $(KV2mainsource) $(KV2secondaryfiles)
	-latex -interaction=batchmode $(KV2mainsource)
	-latex -interaction=batchmode $(KV2mainsource)
	-latex -interaction=batchmode $(KV2mainsource)
	makeindex $(KV2mainidx)
	latex -interaction=batchmode $(KV2mainsource)

$(LMmaindvi) : $(LMbitmapepsfiles) $(LMepsfiles) $(LMmainsource) $(LMsecondaryfiles)
	-latex -interaction=batchmode $(LMmainsource)
	-latex -interaction=batchmode $(LMmainsource)
	-latex -interaction=batchmode $(LMmainsource)
	makeindex $(LMmainidx)
	latex -interaction=batchmode $(LMmainsource)

$(MMMmaindvi) : $(MMMbitmapepsfiles) $(MMMepsfiles) $(MMMmainsource) $(MMMsecondaryfiles)
	-latex -interaction=batchmode $(MMMmainsource)
	-latex -interaction=batchmode $(MMMmainsource)
	-latex -interaction=batchmode $(MMMmainsource)
	makeindex $(MMMmainidx)
	latex -interaction=batchmode $(MMMmainsource)

$(MpMmaindvi) : $(MpMbitmapepsfiles) $(MpMepsfiles) $(MpMmainsource) $(MpMsecondaryfiles)
	-latex -interaction=batchmode $(MpMmainsource)
	-latex -interaction=batchmode $(MpMmainsource)
	-latex -interaction=batchmode $(MpMmainsource)
	makeindex $(MpMmainidx)
	latex -interaction=batchmode $(MpMmainsource)

$(NNmaindvi) : $(NNbitmapepsfiles) $(NNepsfiles) $(NNmainsource) $(NNsecondaryfiles)
	-latex -interaction=batchmode $(NNmainsource)
	-latex -interaction=batchmode $(NNmainsource)
	-latex -interaction=batchmode $(NNmainsource)
	makeindex $(NNmainidx)
	latex -interaction=batchmode $(NNmainsource)

$(OSmaindvi) : $(OSbitmapepsfiles) $(OSepsfiles) $(OSmainsource) $(OSsecondaryfiles)
	-latex -interaction=batchmode $(OSmainsource)
	-latex -interaction=batchmode $(OSmainsource)
	-latex -interaction=batchmode $(OSmainsource)
	makeindex $(OSmainidx)
	latex -interaction=batchmode $(OSmainsource)

$(PC2maindvi) : $(PC2bitmapepsfiles) $(PC2epsfiles) $(PC2mainsource) $(PC2secondaryfiles)
	-latex -interaction=batchmode $(PC2mainsource)
	-latex -interaction=batchmode $(PC2mainsource)
	-latex -interaction=batchmode $(PC2mainsource)
	makeindex $(PC2mainidx)
	latex -interaction=batchmode $(PC2mainsource)

$(SMmaindvi) : $(SMbitmapepsfiles) $(SMepsfiles) $(SMmainsource) $(SMsecondaryfiles)
	-latex -interaction=batchmode $(SMmainsource)
	-latex -interaction=batchmode $(SMmainsource)
	-latex -interaction=batchmode $(SMmainsource)
	makeindex $(SMmainidx)
	latex -interaction=batchmode $(SMmainsource)

$(VDSmaindvi) : $(VDSbitmapepsfiles) $(VDSepsfiles) $(VDSmainsource) $(VDSsecondaryfiles)
	-latex -interaction=batchmode $(VDSmainsource)
	-latex -interaction=batchmode $(VDSmainsource)
	-latex -interaction=batchmode $(VDSmainsource)
	makeindex $(VDSmainidx)
	latex -interaction=batchmode $(VDSmainsource)

# Specific rules (HTML)

$(IMmainhtml) : $(IMbitmappngfiles) $(IMpngfiles) $(IMmainsource) $(IMsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(IMmainsource) -o $@

$(JSmainhtml) : $(JSbitmappngfiles) $(JSpngfiles) $(JSmainsource) $(JSsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(JSmainsource) -o $@

$(KV2mainhtml) : $(KV2bitmappngfiles) $(KV2pngfiles) $(KV2mainsource) $(KV2secondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(KV2mainsource) -o $@

$(LMmainhtml) : $(LMbitmappngfiles) $(LMpngfiles) $(LMmainsource) $(LMsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(LMmainsource) -o $@

$(MMMmainhtml) : $(MMMbitmappngfiles) $(MMMpngfiles) $(MMMmainsource) $(MMMsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(MMMmainsource) -o $@

$(MpMmainhtml) : $(MpMbitmappngfiles) $(MpMpngfiles) $(MpMmainsource) $(MpMsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(MpMmainsource) -o $@

$(NNmainhtml) : $(NNbitmappngfiles) $(NNpngfiles) $(NNmainsource) $(NNsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(NNmainsource) -o $@

$(OSmainhtml) : $(OSbitmappngfiles) $(OSpngfiles) $(OSmainsource) $(OSsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(OSmainsource) -o $@

$(PC2mainhtml) : $(PC2bitmappngfiles) $(PC2pngfiles) $(PC2mainsource) $(PC2secondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(PC2mainsource) -o $@

$(SMmainhtml) : $(SMbitmappngfiles) $(SMpngfiles) $(SMmainsource) $(SMsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(SMmainsource) -o $@

$(VDSmainhtml) : $(VDSbitmappngfiles) $(VDSpngfiles) $(VDSmainsource) $(VDSsecondaryfiles)
	-hevea -O -fix -exec xxdate.exe $(VDSmainsource) -o $@

$(IMAGE_ARCHIVE) : $(IMbitmappngfiles) $(JSbitmappngfiles) $(KV2bitmappngfiles) \
		$(LMbitmappngfiles) $(MMMbitmappngfiles) $(MpMbitmappngfiles) \
		$(NNbitmappngfiles) $(OSbitmappngfiles) $(PC2bitmappngfiles) $(SMbitmappngfiles) \
		$(VDSbitmappngfiles) $(Commonpngfiles) $(IMpngfiles) $(JSpngfiles) \
		$(KV2pngfiles) $(LMpngfiles) $(MMMpngfiles) $(MpMpngfiles) $(NNpngfiles) \
		$(OSpngfiles) $(PC2pngfiles) $(SMpngfiles) $(VDSpngfiles) 
	tar -czf $(IMAGE_ARCHIVE) $(IMAGE_DIR)

# Top-level targets

.PHONY : clean all

.PRECIOUS : %.eps %.ps %.pdf

clean :
	-rm -f *.log *.pdf *.mpx *.dvi *.aux *.idx *.ilg *.ind *.lof *.out *.png *.ps *.eps
	-rm -f *.html *.toc *.htoc *.haux *.hind $(IMAGE_ARCHIVE)
#	-rm -f *.html *.toc *.htoc *.haux *.hind $(IMAGE_DIR)/*.png $(IMAGE_ARCHIVE)

all : $(IMtarget) $(JStarget) $(KV2target) $(LMtarget) $(MMMtarget) $(MpMtarget) \
		$(NNtarget) $(OStarget) $(PC2target) $(SMtarget) $(VDStarget) $(ARCHIVEtarget)
